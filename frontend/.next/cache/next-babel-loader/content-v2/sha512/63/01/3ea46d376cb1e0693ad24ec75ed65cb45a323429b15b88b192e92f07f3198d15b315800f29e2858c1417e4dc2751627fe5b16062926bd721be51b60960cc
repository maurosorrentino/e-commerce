{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport Link from 'next/link';\nimport Form from './styles/Form';\nimport MessageStyles from './styles/MessageStyles';\nimport Header from './Header';\n\nvar Login = /*#__PURE__*/function (_Component) {\n  _inherits(Login, _Component);\n\n  var _super = _createSuper(Login);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"handleInputs\", function (e) {\n      var _this$setState;\n\n      /* messaage: null so that we can keep the class of the message red on change */\n      _this.setState((_this$setState = {}, _defineProperty(_this$setState, e.target.name, e.target.value), _defineProperty(_this$setState, \"message\", null), _this$setState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"loginHandler\", function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        loading: true\n      });\n\n      _this.fetchData();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchData\", function () {\n      fetch(\"\".concat(process.env.LOCALHOST, \"/auth/login\"), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        credentials: \"include\",\n        body: JSON.stringify({\n          email: _this.state.email,\n          password: _this.state.password\n        })\n      }).then(function (res) {\n        return res.json();\n      }).then(function (resData) {\n        _this.setState({\n          message: resData.message,\n          loading: false\n        }); // we only want to show the user one of these 3 messages\n\n\n        if (resData.message !== 'invalid password, please try again' && resData.message !== \"There is no account into our database with this email: \".concat(_this.state.email) && resData.message !== 'Successful Login, You Are Being Redirected To Our Shop') {\n          _this.setState({\n            message: null\n          });\n        }\n\n        ;\n\n        if (_this.state.email === '') {\n          _this.setState({\n            message: null\n          });\n        }\n\n        ; // redirecting to the shop page at successful login\n\n        if (resData.message === 'Successful Login, You Are Being Redirected To Our Shop') {\n          setTimeout(function () {\n            window.location.replace('/');\n          }, 2000);\n        }\n      })[\"catch\"](function (err) {\n        _this.setState({\n          loading: false\n        });\n\n        console.log(err);\n      });\n    });\n\n    _this.state = {\n      email: '',\n      password: '',\n      message: null,\n      loading: false\n    };\n    _this.fetchData = _this.fetchData.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, null), this.state.message && /*#__PURE__*/React.createElement(MessageStyles, null, /*#__PURE__*/React.createElement(\"h1\", {\n        className: this.state.message === \"There is no account into our database with this email: \".concat(this.state.email) || this.state.message === 'invalid password, please try again' ? 'red' : '',\n        id: \"message-test\"\n      }, this.state.message)), /*#__PURE__*/React.createElement(Form, {\n        id: \"login-form-test\",\n        onSubmit: this.loginHandler\n      }, /*#__PURE__*/React.createElement(\"fieldset\", {\n        \"aria-busy\": this.state.loading,\n        disabled: this.state.loading\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        id: \"h1-test\"\n      }, \"Log\", this.state.loading ? 'ging' : '', \" In\"), /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"email\"\n      }, \"Email\", /*#__PURE__*/React.createElement(\"input\", {\n        id: \"email-test\",\n        name: \"email\",\n        type: \"email\",\n        placeholder: \"enter your email\",\n        value: this.state.email,\n        onChange: this.handleInputs,\n        className: this.state.message === \"There is no account into our database with this email: \".concat(this.state.email) ? 'invalid' : ''\n      })), /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"password\"\n      }, \"Password\", /*#__PURE__*/React.createElement(\"input\", {\n        id: \"password-test\",\n        name: \"password\",\n        type: \"password\",\n        placeholder: \"enter your password\",\n        value: this.state.password,\n        onChange: this.handleInputs,\n        className: this.state.message === 'invalid password, please try again' ? 'invalid' : ''\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        id: \"button-test\"\n      }, \"Log\", this.state.loading ? 'ging' : '', \" in!\"), /*#__PURE__*/React.createElement(Link, {\n        href: \"/reset-password\"\n      }, /*#__PURE__*/React.createElement(\"button\", null, \"Reset Password\")))));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}