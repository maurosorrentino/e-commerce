{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal[\"default\"].signature : function (a) {\n  return a;\n};\n\nimport React, { Component } from 'react';\nimport Form from '../components/styles/Form';\nimport MessageStyles from '../components/styles/MessageStyles';\n\nvar ResetPasswordPage = /*#__PURE__*/function (_Component) {\n  _inherits(ResetPasswordPage, _Component);\n\n  var _super = _createSuper(ResetPasswordPage);\n\n  function ResetPasswordPage() {\n    var _this;\n\n    _classCallCheck(this, ResetPasswordPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      loading: false,\n      message: null,\n      password: '',\n      confirmPassword: ''\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchData\", function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        loading: true\n      });\n\n      var resetToken = _this.props.resetToken;\n      var userId = _this.props.userId; // we need to encode the api point in order to connect to it\n\n      fetch(\"\".concat(process.env.NEXT_PUBLIC_API_URL, \"/api/reset-password-form/\").concat(encodeURIComponent(resetToken), \"/\").concat(userId), {\n        method: 'PATCH',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          password: _this.state.password,\n          confirmPassword: _this.state.confirmPassword\n        })\n      }).then(function (res) {\n        return res.json();\n      }).then(function (resData) {\n        _this.setState({\n          message: resData.message,\n          loading: false\n        });\n      }).then(function () {\n        // redirecting to login page in case of success\n        if (_this.state.message === 'You Have Changed Your Password, You Are Being Readirected To The Login Page') {\n          setTimeout(function () {\n            window.location.replace('/auth/login');\n          }, 2000);\n        } // redirecting to reset password page in case of error in order to make the user request another reset password\n\n\n        if (_this.state.message === 'Forbidden! Please Request Another Password Reset, You Are Being Redirected To Reset Password Page' || _this.state.message === 'Sorry, We Could Not Find An Account, Please Request Another Password Reset. You Are Being Redirected To The Page') {\n          setTimeout(function () {\n            window.location.replace('/reset-password');\n          }, 2000);\n        }\n      })[\"catch\"](function (err) {\n        return console.log(err);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(ResetPasswordPage, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, this.state.message && /*#__PURE__*/React.createElement(MessageStyles, null, /*#__PURE__*/React.createElement(\"h1\", {\n        className: this.state.message === 'Forbidden! Please Request Another Password Reset, You Are Being Redirected To Reset Password Page' || this.state.message === 'Sorry, We Could Not Find An Account, Please Request Another Password Reset. You Are Being Redirected To The Page' ? 'red' : '',\n        id: \"message-test\"\n      }, this.state.message)), /*#__PURE__*/React.createElement(Form, {\n        onSubmit: this.fetchData\n      }, /*#__PURE__*/React.createElement(\"fieldset\", {\n        \"aria-busy\": this.state.loading,\n        disabled: this.state.loading\n      }, /*#__PURE__*/React.createElement(\"h1\", null, \"Chang\", this.state.loading ? 'ing' : 'e', \" Your Password\"), /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"password\"\n      }, \"Password\", /*#__PURE__*/React.createElement(\"input\", {\n        name: \"password\",\n        type: \"password\",\n        onChange: this.handleChange,\n        value: this.state.password,\n        className: this.state.message === 'Password Needs To Be At Least 5 characters' ? 'invalid' : '',\n        placeholder: \"enter your new password\"\n      })), /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"confirm password\"\n      }, \"Confirm Password\", /*#__PURE__*/React.createElement(\"input\", {\n        name: \"confirmPassword\",\n        type: \"password\",\n        onChange: this.handleChange,\n        value: this.state.confirmPassword,\n        className: this.state.message === 'Passwords Do Not Match!' ? 'invalid' : '',\n        placeholder: \"please confirm your new password\"\n      })), /*#__PURE__*/React.createElement(\"button\", null, \"Chang\", this.state.loading ? 'ing' : 'e', \" Your Password\"))));\n    }\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    value: // @ts-ignore\n    function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n\n  return ResetPasswordPage;\n}(Component);\n\nvar _default = ResetPasswordPage;\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(ResetPasswordPage, \"ResetPasswordPage\", \"/Users/stefano.mezza/Downloads/e-commerce/frontend/components/ResetPasswordPage.js\");\n  reactHotLoader.register(_default, \"default\", \"/Users/stefano.mezza/Downloads/e-commerce/frontend/components/ResetPasswordPage.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/stefano.mezza/Downloads/e-commerce/frontend/components/ResetPasswordPage.js"],"names":["React","Component","Form","MessageStyles","ResetPasswordPage","loading","message","password","confirmPassword","e","setState","target","name","value","preventDefault","resetToken","props","userId","fetch","process","env","NEXT_PUBLIC_API_URL","encodeURIComponent","method","headers","credentials","body","JSON","stringify","state","then","res","json","resData","setTimeout","window","location","replace","err","console","log","fetchData","handleChange"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport Form from '../components/styles/Form';\nimport MessageStyles from '../components/styles/MessageStyles';\n\nclass ResetPasswordPage extends Component {\n\n    state = {\n\n        loading: false,\n        message: null,\n        password: '',\n        confirmPassword: '',\n        \n    }\n\n    handleChange = e => {\n\n        this.setState({ [e.target.name]: e.target.value });\n\n    }\n\n    fetchData = e => {\n\n        e.preventDefault();\n\n        this.setState({ loading: true })\n\n        const resetToken = this.props.resetToken;\n        const userId = this.props.userId;\n\n        // we need to encode the api point in order to connect to it\n        fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/reset-password-form/${encodeURIComponent(resetToken)}/${userId}`, {\n\n            method: 'PATCH',\n\n            headers: {\n\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n\n            },\n\n            credentials: 'include',\n\n            body: JSON.stringify({\n\n                password: this.state.password,\n                confirmPassword: this.state.confirmPassword,\n\n            })\n\n        })\n\n        .then(res => {\n\n            return res.json();\n\n        })\n\n        .then(resData => {\n\n            this.setState({ message: resData.message, loading: false });\n\n        })\n\n        .then(() => {\n\n            // redirecting to login page in case of success\n            if(this.state.message === 'You Have Changed Your Password, You Are Being Readirected To The Login Page') {\n\n                setTimeout(() => {\n\n                    window.location.replace('/auth/login');\n                    \n                }, 2000);\n\n            }\n\n            // redirecting to reset password page in case of error in order to make the user request another reset password\n            if(this.state.message === 'Forbidden! Please Request Another Password Reset, You Are Being Redirected To Reset Password Page'\n            || this.state.message === 'Sorry, We Could Not Find An Account, Please Request Another Password Reset. You Are Being Redirected To The Page') {\n\n                setTimeout(() => {\n\n                    window.location.replace('/reset-password');\n                    \n                }, 2000);\n\n            }\n\n        }) \n\n        .catch(err => console.log(err))\n\n    }\n\n    render() {\n\n        return (\n<>\n\n            { this.state.message && (<MessageStyles><h1 className={\n\n                this.state.message === 'Forbidden! Please Request Another Password Reset, You Are Being Redirected To Reset Password Page'\n                || this.state.message === 'Sorry, We Could Not Find An Account, Please Request Another Password Reset. You Are Being Redirected To The Page' ? 'red' : ''\n\n            } id=\"message-test\">{this.state.message}</h1></MessageStyles> ) }\n\n            <Form onSubmit={this.fetchData}>\n\n                <fieldset aria-busy={this.state.loading} disabled={this.state.loading}>\n\n                    <h1>Chang{this.state.loading ? 'ing' : 'e'} Your Password</h1>\n\n                    <label htmlFor=\"password\">\n\n                        Password\n\n                        <input\n\n                            name=\"password\"\n                            type=\"password\"\n                            onChange={this.handleChange}\n                            value={this.state.password}\n                            className={this.state.message === 'Password Needs To Be At Least 5 characters' ? 'invalid' : '' }\n                            placeholder=\"enter your new password\"\n\n                        />\n\n                    </label>\n\n                    <label htmlFor=\"confirm password\">\n\n                        Confirm Password\n\n                        <input\n\n                            name=\"confirmPassword\"\n                            type=\"password\"\n                            onChange={this.handleChange}\n                            value={this.state.confirmPassword}\n                            className={this.state.message === 'Passwords Do Not Match!' ? 'invalid' : '' }\n                            placeholder=\"please confirm your new password\"\n\n                        />\n\n                    </label>\n\n                    <button>Chang{this.state.loading ? 'ing' : 'e'} Your Password</button>\n\n                </fieldset>\n\n            </Form>\n\n</>\n        )\n\n    }\n\n}\n\nexport default ResetPasswordPage;"]},"metadata":{},"sourceType":"module"}