{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal[\"default\"].signature : function (a) {\n  return a;\n};\n\nimport React from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nvar stripePromise = loadStripe(process.env.STRIPE);\n\nfunction Checkout() {\n  var handleClick = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var stripe, res, session, result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return stripePromise;\n\n            case 2:\n              stripe = _context.sent;\n              _context.next = 5;\n              return fetch(\"\".concat(process.env.NEXT_PUBLIC_API_URL, \"/auth/api/create-checkout-session\"), {\n                method: 'POST',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json'\n                },\n                credentials: 'include'\n              });\n\n            case 5:\n              res = _context.sent;\n              _context.next = 8;\n              return res.json();\n\n            case 8:\n              session = _context.sent;\n              _context.next = 11;\n              return stripe.redirectToCheckout({\n                sessionId: session.id\n              });\n\n            case 11:\n              result = _context.sent;\n\n              if (result.error) {\n                console.log(result.error);\n              }\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleClick(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"button\", {\n    id: \"checkoutButton\",\n    onClick: handleClick\n  }, \"checkout\");\n}\n\n_c = Checkout;\nvar _default = Checkout;\nexport default _default;\n\nvar _c;\n\n$RefreshReg$(_c, \"Checkout\");\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(stripePromise, \"stripePromise\", \"/Users/stefano.mezza/e-commerce/frontend/components/Checkout.js\");\n  reactHotLoader.register(Checkout, \"Checkout\", \"/Users/stefano.mezza/e-commerce/frontend/components/Checkout.js\");\n  reactHotLoader.register(_default, \"default\", \"/Users/stefano.mezza/e-commerce/frontend/components/Checkout.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/stefano.mezza/e-commerce/frontend/components/Checkout.js"],"names":["React","loadStripe","stripePromise","process","env","STRIPE","Checkout","handleClick","e","stripe","fetch","NEXT_PUBLIC_API_URL","method","headers","credentials","res","json","session","redirectToCheckout","sessionId","id","result","error","console","log"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,mBAA3B;AAEA,IAAMC,aAAa,GAAGD,UAAU,CAACE,OAAO,CAACC,GAAR,CAAYC,MAAb,CAAhC;;AAEA,SAASC,QAAT,GAAoB;AAEhB,MAAMC,WAAW;AAAA,wEAAG,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAGKN,aAHL;;AAAA;AAGVO,cAAAA,MAHU;AAAA;AAAA,qBAMEC,KAAK,WAAIP,OAAO,CAACC,GAAR,CAAYO,mBAAhB,wCAAwE;AAE3FC,gBAAAA,MAAM,EAAE,MAFmF;AAI3FC,gBAAAA,OAAO,EAAE;AAEL,4BAAU,kBAFL;AAGL,kCAAgB;AAHX,iBAJkF;AAW3FC,gBAAAA,WAAW,EAAE;AAX8E,eAAxE,CANP;;AAAA;AAMVC,cAAAA,GANU;AAAA;AAAA,qBAqBMA,GAAG,CAACC,IAAJ,EArBN;;AAAA;AAqBVC,cAAAA,OArBU;AAAA;AAAA,qBAwBKR,MAAM,CAACS,kBAAP,CAA0B;AAE3CC,gBAAAA,SAAS,EAAEF,OAAO,CAACG;AAFwB,eAA1B,CAxBL;;AAAA;AAwBVC,cAAAA,MAxBU;;AA8BhB,kBAAGA,MAAM,CAACC,KAAV,EAAiB;AAEbC,gBAAAA,OAAO,CAACC,GAAR,CAAYH,MAAM,CAACC,KAAnB;AAEH;;AAlCe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAXf,WAAW;AAAA;AAAA;AAAA,KAAjB;;AAsCA,sBAAO;AAAQ,IAAA,EAAE,EAAC,gBAAX;AAA4B,IAAA,OAAO,EAAEA;AAArC,gBAAP;AAEH;;KA1CQD,Q;eA4CMA,Q;AAAf;;;;;;;;;;;;;;0BA9CMJ,a;0BAEGI,Q","sourcesContent":["import React from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\n\nconst stripePromise = loadStripe(process.env.STRIPE);\n\nfunction Checkout() {\n\n    const handleClick = async (e) => {\n\n        // get stripe instance\n        const stripe = await stripePromise;\n\n        // calling API end point to create checkout session\n        const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/auth/api/create-checkout-session`, {\n\n            method: 'POST',\n\n            headers: {\n\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n\n            },\n\n            credentials: 'include',\n\n        });\n\n        const session = await res.json();\n \n        // when user clicks on the button we redirect to the checkout page\n        const result = await stripe.redirectToCheckout({\n\n            sessionId: session.id,\n\n        });\n\n        if(result.error) {\n\n            console.log(result.error);\n\n        } \n\n    };\n\n    return <button id=\"checkoutButton\" onClick={handleClick}>checkout</button>\n\n}\n\nexport default Checkout;"]},"metadata":{},"sourceType":"module"}